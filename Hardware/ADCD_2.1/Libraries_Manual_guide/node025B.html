<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="Libraries/Lib_15" NODE="15-3-3" TITLE="15 / GadTools Gadgets / Handling Gadget Messages" INDEX="Libraries/Lib_Index/MAIN" -->
<head>
<title>15 / GadTools Gadgets / Handling Gadget Messages</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<a href="../Libraries_Manual_guide/node002C.html"><img src="../images/index.gif" alt="[Index]" border=0></a>
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Libraries_Manual_guide/node025A.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Libraries_Manual_guide/node025C.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->
GadTools gadgets follow the same input model as other Intuition
components.  When the user operates a GadTools gadget, Intuition notifies
the application about the input event by sending an <a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a>.  The
application can get these messages at the <a href="../Libraries_Manual_guide/node0121.html">Window</a>.UserPort.  However
GadTools gadgets use different message handling functions to get and reply
these messages.  Instead of the Exec functions <a href="../Libraries_Manual_guide/node02F2.html">GetMsg()</a> and <a href="../Libraries_Manual_guide/node02F3.html">ReplyMsg()</a>,
applications should get and reply these messages through a pair of special
GadTools functions, <a href="../Includes_and_Autodocs_2._guide/node03F2.html">GT_GetIMsg()</a> and <a href="../Includes_and_Autodocs_2._guide/node03F5.html">GT_ReplyIMsg()</a>.

    struct IntuiMessage *GT_GetIMsg(struct MsgPort *iport)
    void  GT_ReplyIMsg(struct IntuiMessage *imsg)

For <a href="../Includes_and_Autodocs_2._guide/node03F2.html">GT_GetIMsg()</a>, the iport argument should be set to the window's
UserPort.  For <a href="../Includes_and_Autodocs_2._guide/node03F5.html">GT_ReplyIMsg()</a>, the imsg argument should be set to a
pointer to the <a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a> returned by GT_GetIMsg().

These functions ensure that the application only sees the gadget events
that concern it and in a desirable form.  For example, with a GadTools
slider gadget, a message only gets through to the application when the
slider's level actually changes and that level can be found in the
<a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a>'s <a href="../Libraries_Manual_guide/node01D9.html#line33">Code</a> field:

    imsg = GT_GetIMsg(win-&#062;UserPort);
    object = imsg-&#062;IAddress;
    class = imsg-&#062;Class;
    code = imsg-&#062;Code;
    GT_ReplyIMsg(imsg);
    switch (class)
        {
        case IDCMP_MOUSEMOVE:
            if (object == slidergad)
                {
                printf(&#034;Slider at level %ld\n&#034;, code);
                }
            ...
            break;
        ...
        }

In general, the <a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a>s received from GadTools contain more
information in the <a href="../Libraries_Manual_guide/node01D9.html#line33">Code</a> field than is found in regular Intuition gadget
messages.  Also, when dealing with GadTools a lot of messages (mostly
<a href="../Libraries_Manual_guide/node01DC.html#line23">IDCMP_MOUSEMOVE</a>s) do not have to be processed by the application.  These
are two reasons why dealing with GadTools gadgets is much easier than
dealing with regular Intuition gadgets.  Unfortunately this processing
cannot happen magically, so applications must use <a href="../Includes_and_Autodocs_2._guide/node03F2.html">GT_GetIMsg()</a> and
<a href="../Includes_and_Autodocs_2._guide/node03F5.html">GT_ReplyIMsg()</a> where they would normally have used <a href="../Libraries_Manual_guide/node02F2.html">GetMsg()</a> and <a href="../Libraries_Manual_guide/node02F3.html">ReplyMsg()</a>.

<a href="../Includes_and_Autodocs_2._guide/node03F2.html">GT_GetIMsg()</a> actually calls <a href="../Libraries_Manual_guide/node02F2.html">GetMsg()</a> to remove a message from the
specified window's UserPort.  If the message pertains to a GadTools gadget
then some dispatching code in GadTools will be called to process the
message.  What the program will receive from GT_GetIMsg() is actually a
copy of the real <a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a>, possibly with some supplementary
information from GadTools, such as the information typically found in the
<a href="../Libraries_Manual_guide/node01D9.html#line33">Code</a> field.

The <a href="../Includes_and_Autodocs_2._guide/node03F5.html">GT_ReplyIMsg()</a> call will take care of cleaning up and replying to the
real <a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a>.

    Warning:
    --------
    When an <a href="../Libraries_Manual_guide/node01DC.html#line23">IDCMP_MOUSEMOVE</a> message is received from a GadTools gadget,
    GadTools arranges to have the gadget's pointer in the <a href="../Libraries_Manual_guide/node01D9.html#line73">IAddress</a>
    field of the <a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a>.  While this is extremely convenient, it
    is also untrue of messages from regular Intuition gadgets (described
    in the &#034;<a href="../Libraries_Manual_guide/node0148.html#line5">Intuition Gadgets</a>&#034; chapter).  Do not make the mistake of
    assuming it to be true.

This description of the inner workings of <a href="../Includes_and_Autodocs_2._guide/node03F2.html">GT_GetIMsg()</a> and <a href="../Includes_and_Autodocs_2._guide/node03F5.html">GT_ReplyIMsg()</a>
is provided for understanding only; it is crucial that the program make no
assumptions or interpretations about the real <a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a>.  Any such
inferences are not likely to hold true in the future.  See the section on
<a href="../Libraries_Manual_guide/node0277.html">documented side-effects</a> for more information.
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
