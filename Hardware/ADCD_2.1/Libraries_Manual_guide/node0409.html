<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="Libraries/Lib_31" NODE="31-8" TITLE="31 Commodities Exchange Library / Sender CxObjects" INDEX="Libraries/Lib_Index/MAIN" -->
<head>
<title>31 Commodities Exchange Library / Sender CxObjects</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<a href="../Libraries_Manual_guide/node002C.html"><img src="../images/index.gif" alt="[Index]" border=0></a>
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Libraries_Manual_guide/node0408.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Libraries_Manual_guide/node040A.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->
A <a href="../Libraries_Manual_guide/node0407.html">filter CxObject</a> by itself is not especially useful.  It needs some other
<a href="../Libraries_Manual_guide/node0401.html">CxObjects</a> attached to it.  A commodity interested in knowing if a specific
key was pressed uses a filter to detect and divert the corresponding
<a href="../Libraries_Manual_guide/node0403.html">CxMessage</a> down the filter's personal list.  The filter does this without
letting the commodity know what happened.  The sender CxObject can be
attached to a filter to notify a commodity that it received a CxMessage.
<a href="../Includes_and_Autodocs_2._guide/node014E.html">CxSender()</a> is a macro that creates a sender CxObject.

    senderCxObj = CxObj *CxSender(struct MsgPort *senderport, LONG cxmID);

<a href="../Includes_and_Autodocs_2._guide/node014E.html">CxSender()</a> supplies the sender with an Exec message port and an ID.  For
every <a href="../Libraries_Manual_guide/node0403.html">CxMessage</a> a sender receives, it sends a new CxMessage to the Exec
message port passed in CxSender().  Normally, the commodity creates this
port.  It is not unusual for a commodity's <a href="../Libraries_Manual_guide/node0402.html">broker</a> and sender(s) to share
an Exec message port.  The <a href="../Libraries_Manual_guide/node0587.html">HotKey.c</a> example does this to avoid creating
unnecessary message ports.  A sender uses the ID (cxmID) passed to
CxSender() as the ID for all the CxMessages that the it transmits.  A
commodity uses the ID to monitor CxMessages from several senders at a
single message port.

A sender does several things when it receives a <a href="../Libraries_Manual_guide/node0403.html">CxMessage</a>.  First, it
duplicates the CxMessage's corresponding input event and creates a new
CxMessage.  Then, it points the new CxMessage's data field to the copy of
the input event and sets the new CxMessage's ID to the ID passed to
<a href="../Includes_and_Autodocs_2._guide/node014E.html">CxSender()</a>.  Finally, it sends the new CxMessage to the port passed to
CxSender(), asynchronously.

Because HotKey uses only one message port between its <a href="../Libraries_Manual_guide/node0402.html">broker</a> and sender
object, it has to extract the <a href="../Libraries_Manual_guide/node0403.html">CxMessage</a>'s type so it can tell if it is a
CXM_IEVENT or a CXM_COMMAND.  If HotKey gets a CXM_IEVENT, it compares the
CxMessage's ID to the sender's ID, EVT_HOTKEY, to see which sender sent
the CxMessage.  Of course HotKey has only one sender, so it only checks
for only one ID.  If it had more senders, HotKey would check for the ID of
each of the other senders as well.

Although HotKey doesn't use it, a <a href="../Libraries_Manual_guide/node0403.html">CXM_IEVENT CxMessage</a> contains a pointer
to the copy of an input event.  A commodity can extract this pointer
( using <a href="../Libraries_Manual_guide/node0403.html#line10">CxMsgData()</a> ) if it needs to examine the input event copy.  This
pointer is only valid before the CxMessage reply.  Note that it does not
make any sense to modify the input event copy.

Senders are attached almost exclusively to <a href="../Libraries_Manual_guide/node0401.html">CxObjects</a> that filter out most
input events (usually a <a href="../Libraries_Manual_guide/node0407.html">filter CxObject</a>).  Because a sender sends a
<a href="../Libraries_Manual_guide/node0403.html">CxMessage</a> for every single input event it gets, it should only get a
select few input events.  The <a href="../Libraries_Manual_guide/node0408.html">AttachCxObj()</a> function can add a CxObject to
the end of a filter's (or some other filtering CxObject's) personal list.
A commodity should not attach a CxObject to a sender as a sender ignores
any CxObjects in its personal list.
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
