<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="Libraries/Lib_B" NODE="B-10-4" TITLE="B / gadgetclass / New Methods: GM_HANDLEINPUT" INDEX="Libraries/Lib_Index/MAIN" -->
<head>
<title>B / gadgetclass / New Methods: GM_HANDLEINPUT</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<a href="../Libraries_Manual_guide/node002C.html"><img src="../images/index.gif" alt="[Index]" border=0></a>
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Libraries_Manual_guide/node04F5.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Libraries_Manual_guide/node04F7.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->
This method asks an active gadget to handle an input event.  After
Intuition gets an OK to make this gadget object active (see the
<a href="../Libraries_Manual_guide/node04F5.html">GM_GOACTIVE</a> method above), Intuition starts sending input events to the
gadget.  Intuition sends them in the form of a GM_HANDLEINPUT message.
This method uses the same custom message structure as GM_GOACTIVE (see the
<a href="../Libraries_Manual_guide/node04F5.html#line18">gpInput</a> structure above).

The information in the <a href="../Libraries_Manual_guide/node04F5.html#line18">gpInput</a> structure is the same for GM_HANDLEINPUT as
it is for <a href="../Libraries_Manual_guide/node04F5.html">GM_GOACTIVE</a>.  The only difference is that the GM_HANDLEINPUT
message's <a href="../Libraries_Manual_guide/node04F5.html#line33">gpi_IEvent</a> can never be NULL.  It always points to an <a href="../Libraries_Manual_guide/node01D0.html">InputEvent</a>
structure.

The gadget has to examine the incoming InputEvents to see how its state
may have changed.  For example,  a string gadget processes key presses,
inserting them into the gadgets string.  When the string changes, the
gadget has to update its visual state to reflect that change.  Another
example is the prop gadget.  If the user picks up the prop gadget's knob,
the prop gadget has to track the mouse to process changes to the gadget's
internal values.  It does this by processing IECLASS_RAWMOUSE events.

If the GM_HANDLEINPUT method needs to do some rendering, it must call
<a href="../Includes_and_Autodocs_2._guide/node0232.html">ObtainGIRPort()</a> on the GM_HANDLEINPUT message's <a href="../Libraries_Manual_guide/node04F5.html#line18">gpi_GInfo</a> to get a pointer
to a <a href="../Libraries_Manual_guide/node034A.html">RastPort</a>.  To relinquish this RastPort, the GM_HANDLEINPUT method
must call <a href="../Includes_and_Autodocs_2._guide/node0243.html">ReleaseGIRPort()</a>.  The GM_HANDLEINPUT method has to allocate and
<a name="line26">release this RastPort, it cannot be cached in the <a href="../Libraries_Manual_guide/node04F5.html">GM_GOACTIVE</a> method.</a>

The return value from GM_HANDLEINPUT informs Intuition if the gadget wants
to remain active.  The return values for the GM_HANDLEINPUT are similar to
<a href="../Libraries_Manual_guide/node04F5.html">GM_GOACTIVE</a>.  The gadget tells Intuition that it wants to remain active by
returning GMR_MEACTIVE.  A gadget tells Intuition it wants to become
<a name="line32">inactive by returning one of the &#034;go inactive&#034; return values:</a>

GMR_NOREUSE     Tells Intuition to throw away the <a href="../Libraries_Manual_guide/node04F5.html#line18">gpInput.gpi_IEvent</a>
                InputEvent.

GMR_REUSE       Tells Intuition to reprocess the <a href="../Libraries_Manual_guide/node04F5.html#line18">gpInput.gpi_IEvent</a>
                InputEvent after deactivating the gadget.

GMR_NEXTACTIVE  Tells Intuition to throw away the <a href="../Libraries_Manual_guide/node04F5.html#line18">gpInput.gpi_IEvent</a>
                InputEvent and activate the next <a href="../Libraries_Manual_guide/node014A.html#line89">GFLG_TABCYCLE</a> gadget.

GMR_PREVACTIVE  Tells Intuition to throw away the <a href="../Libraries_Manual_guide/node04F5.html#line18">gpInput.gpi_IEvent</a>
                InputEvent and activate the previous <a href="../Libraries_Manual_guide/node014A.html#line89">GFLG_TABCYCLE</a> gadget.

GMR_NOREUSE tells Intuition that the gadget does not want to be active and
should throw away the InputEvent that triggered the GM_HANDLEINPUT message
(or the <a href="../Libraries_Manual_guide/node04F5.html">GM_GOACTIVE</a> message).  For example, an active prop gadget returns
GMR_NOREUSE when the user lets go of the left mouse button (thus letting
go of the prop gadget's knob).

A gadget can also return GMR_REUSE, which tells Intuition to reuse the
InputEvent.  For example, if the user clicks outside of an active string
gadget, that string gadget returns GMR_REUSE so Intuition can process that
mouse click, which could be over another gadget.  Another case where a
string gadget returns GMR_REUSE is when the user pushes the right mouse
button (the menu button).  The string gadget becomes inactive and the menu
button InputEvent gets reused by Intuition so it can pop up the menu bar.

The other two possible return values, GMR_NEXTACTIVE and GMR_PREVACTIVE
were added to the OS for Release 2.04.  These tell Intuition that a gadget
no longer wants to be active and that the GM_HANDLEINPUT message
InputEvent should be discarded.  Intuition then looks for the next
non-disabled (GMR_NEXTACTIVE) or previous (GMR_PREVACTIVE) gadget that has
its <a href="../Libraries_Manual_guide/node014A.html#line89">GFLG_TABCYCLE</a> flag set in its <a href="../Libraries_Manual_guide/node0149.html#line53">Gadget.Activation</a> field (see the
<a href="../Libraries_Manual_guide/node04F2.html">gadgetclass</a> <a href="../Libraries_Manual_guide/node0504.html">GA_TabCycle</a> attribute below), and attempts to activate it.

For both <a href="../Libraries_Manual_guide/node04F5.html">GM_GOACTIVE</a> and GM_HANDLEINPUT, the gadget can bitwise OR any of
these &#034;go inactive&#034; return values with GMR_VERIFY.  The GMR_VERIFY flag
tells Intuition to send a <a href="../Libraries_Manual_guide/node01DD.html#line6">IDCMP_GADGETUP</a> IntuiMessage to the gadget's
window. If the gadget uses GMR_VERIFY, it has to supply a value for the
<a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a>'s <a href="../Libraries_Manual_guide/node01D9.html#line33">Code</a> field.  It does this by passing a value in the
<a href="../Libraries_Manual_guide/node04F5.html#line18">gpInput</a>'s gpi_Termination field.  This field points to a long word, the
lower 16-bits of which Intuition copies into the Code field.  The upper
16-bits are for future enhancements, so clear these bits.
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
