<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="Libraries/Lib_12" NODE="12-1-3" TITLE="12 / OOP Overview / Making Gadget Objects Talk to Each Other" INDEX="Libraries/Lib_Index/MAIN" -->
<head>
<title>12 / OOP Overview / Making Gadget Objects Talk to Each Other</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<a href="../Libraries_Manual_guide/node002C.html"><img src="../images/index.gif" alt="[Index]" border=0></a>
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Libraries_Manual_guide/node020A.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Libraries_Manual_guide/node020C.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->
One use for a proportional gadget is to let the user change some integer
value, like the red, green, and blue components of a color. This type of
prop gadget is commonly accompanied by an integer string gadget, enabling
the user to adjust one integer value by either typing the value into the
string gadget or by scrolling the prop gadget.  Because these two gadgets
reflect the value of the same integer, when the user adjusts the state of
one of the gadgets (and thus changing the integer value), the other gadget
should automatically update to reflect the new integer value.

When the user manipulates a conventional gadget, the gadget sends messages
to an IDCMP port to indicate the state change (for information on IDCMP,
see the &#034;<a href="../Libraries_Manual_guide/node01D6.html">Intuition Input and Output Methods</a>&#034; chapter of this manual).  To
connect the string and prop gadgets from the previous paragraph, an
application would have to listen for the IDCMP messages from two different
gadgets, interpret the IDCMP message's meaning, and manually update the
gadgets accordingly. Essentially, the application is responsible for
&#034;gluing&#034; the gadgets together.  This unnecessarily complicates an
application, especially when that application already has to listen for
<a name="line20">and interpret many other events.</a>

Boopsi gadgets simplify this.  By setting the appropriate attributes, an
application can ask a Boopsi gadget to tell some other object when its
state changes.  One of the attributes defined by <a href="../Libraries_Manual_guide/node020A.html">gadgetclass</a> is <a href="../Libraries_Manual_guide/node04FB.html">ICA_TARGET</a>
(defined in &#060;intuition/<a href="../Includes_and_Autodocs_2._guide/node00DB.html#line26">icclass.h</a>&#062;).  The ICA_TARGET attribute points to
another Boopsi object.  When certain attributes in a Boopsi gadget change
(like the integer value of a prop gadget), that gadget looks to see if it
has an ICA_TARGET.  If it does, it sends the target a message telling it
<a name="line29">to perform an <a href="../Libraries_Manual_guide/node0211.html#line32">OM_UPDATE</a> method.</a>

The <a href="../Libraries_Manual_guide/node0211.html#line32">OM_UPDATE</a> method is defined by <a href="../Libraries_Manual_guide/node0200.html#line50">rootclass</a>.  This is basically a special
type of <a href="../Libraries_Manual_guide/node0211.html#line28">OM_SET</a> method that is used specifically to tell a Boopsi object
that another Boopsi object's state changed.  Only Boopsi objects send
OM_UPDATE messages.  Note that standard classes of Boopsi gadgets only
send out OM_UPDATE messages as a result of the user changing the state of
the gadget (scrolling the prop gadget, typing a new number into an integer
gadget, etc.).  These gadgets do not send out OM_UPDATE messages when they
receive OM_SET or OM_UPDATE messages.

A Boopsi <a href="../Libraries_Manual_guide/node020A.html#line4">propgclass</a> object has only one attribute that triggers it to send
an <a href="../Libraries_Manual_guide/node0211.html#line32">OM_UPDATE</a> request: <a href="../Libraries_Manual_guide/node050F.html">PGA_Top</a>. This attribute contains the integer value
of the prop gadget.  Every time the user moves a prop gadget, the PGA_Top
attribute changes.  If the prop gadget has an <a href="../Libraries_Manual_guide/node04FB.html">ICA_TARGET</a>, the prop gadget
will tell the target object that the PGA_Top value has changed.

A Boopsi integer string gadget (a <a href="../Libraries_Manual_guide/node020A.html#line7">strgclass</a> object) also has only one
attribute that triggers it to send an <a href="../Libraries_Manual_guide/node0211.html#line32">OM_UPDATE</a> request: <a href="../Libraries_Manual_guide/node0512.html">STRINGA_LongVal</a>.
value contains the integer value of the integer string gadget.  Like
the prop gadget, if the integer string gadget has an <a href="../Libraries_Manual_guide/node04FB.html">ICA_TARGET</a>, when the
user changes the gadget's integer value (STRINGA_LongVal), the string
gadget will tell the target object that the STRINGA_LongVal value has
changed.

When a Boopsi gadget sends an <a href="../Libraries_Manual_guide/node0211.html#line32">OM_UPDATE</a> message, it passes the ID of the
attribute that changed plus that attribute's new value.  For example, if
the user typed a 25 into a Boopsi integer string gadget, that gadget would
send an OM_UPDATE message to its <a href="../Libraries_Manual_guide/node04FB.html">ICA_TARGET</a> saying in essence, &#034;Hey,
<a name="line58"><a href="../Libraries_Manual_guide/node0512.html">STRINGA_LongVal</a> is 25&#034;.</a>

If this string gadget's <a href="../Libraries_Manual_guide/node04FB.html">ICA_TARGET</a> is a <a href="../Libraries_Manual_guide/node020A.html#line4">propgclass</a> object, the propgclass
object will become confused because it has no idea what a <a href="../Libraries_Manual_guide/node0512.html">STRINGA_LongVal</a>
attribute is.  The string gadget needs to map its STRINGA_LongVal ID to
<a name="line63">the <a href="../Libraries_Manual_guide/node050F.html">PGA_Top</a> ID.  This is what the <a href="../Libraries_Manual_guide/node04FC.html">ICA_MAP</a> attribute is for.</a>

The ICA_MAP attribute is defined by <a href="../Libraries_Manual_guide/node04FC.html">gadgetclass</a> (it is also defined for
<a href="../Libraries_Manual_guide/node04C9.html">icclass</a>--more on that later).  It accepts a tag list of attribute
mappings.  When a gadget sends out an <a href="../Libraries_Manual_guide/node0211.html#line32">OM_UPDATE</a> message, it uses this map
to translate a specific attribute ID to another attribute ID, without
changing the value of the attribute.  Each <a href="../Libraries_Manual_guide/node0497.html">TagItem</a> in the ICA_MAP makes up
a single attribute mapping. The TagItem.ti_Tag of the mapping is the ID of
an attribute to translate.  The gadget translates that attribute ID to the
attribute ID in TagItem.ti_Data.  For example, an ICA_MAP that maps a
string gadget's <a href="../Libraries_Manual_guide/node0512.html">STRINGA_LongVal</a> attribute to a prop gadget's <a href="../Libraries_Manual_guide/node050F.html">PGA_Top</a>
attribute looks like this:

    struct TagItem slidertostring[] = {
        {PGA_Top, STRINGA_LongVal},
        {TAG_END, }
    };

Note that it is OK to have an ICA_TARGET without having an ICA_MAP.  In
cases where a gadget and its <a href="../Libraries_Manual_guide/node04FB.html">ICA_TARGET</a> have a set of attributes in
common, it would be unnecessary to use an <a href="../Libraries_Manual_guide/node04FC.html">ICA_MAP</a> to match a gadget's
attributes, as they already match.

The following example, Talk2boopsi.c, creates a prop gadget and an integer
string gadget which update each other without the example program having
to process any messages from them.

     <a href="../Libraries_Manual_guide/node0582.html">Talk2boopsi.c</a> 
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
