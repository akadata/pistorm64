<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="Libraries/Lib_21" NODE="21-3" TITLE="21 Exec Tasks / Task Termination" INDEX="Libraries/Lib_Index/MAIN" -->
<head>
<title>21 Exec Tasks / Task Termination</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<a href="../Libraries_Manual_guide/node002C.html"><img src="../images/index.gif" alt="[Index]" border=0></a>
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Libraries_Manual_guide/node02BF.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Libraries_Manual_guide/node02C1.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->
<a name="line2">Task termination may occur as the result of a number of situations:</a>

  * A program returning from its <a href="../Libraries_Manual_guide/node02BC.html#line35">initialPC</a> routine and dropping into its
    <a href="../Libraries_Manual_guide/node02BC.html#line35">finalPC</a> routine or the system default finalizer.

  * A task trap that is too serious for a recovery action. This includes
<a name="line8">    traps like processor bus error, odd address access errors, etc.</a>

  * A trap that is not handled by the task.  For example, the task might
    be terminated if your code happened to encounter a processor TRAP
<a name="line12">    instruction and you did not provide a trap handling routine.</a>

<a name="line14">  * An explicit call to Exec <a href="../Libraries_Manual_guide/node02D0.html#line5">RemTask()</a> or amiga.lib <a href="../Libraries_Manual_guide/node02BD.html#line6">DeleteTask()</a>.</a>

Task termination involves the deallocation of system resources and the
removal of the task structure from Exec.  The most important part of task
termination is the deallocation of system resources.  A task must return
all memory that it allocated for its private use, it must terminate any
outstanding I/O commands, and it must close access to any system libraries
<a name="line21">or devices that it has opened.</a>

It is wise to adopt a strategy for task clean-up responsibility.  You
should decide whether resource allocation and deallocation is the duty of
the creator task or the newly created task.  Often it is easier and safer
for the creator to handle the resource allocation and deallocation on
behalf of its offspring.  In such cases, before removing the child task,
you must make sure it is in a safe state such as <a href="../Libraries_Manual_guide/node02D4.html">Wait</a>(0L) and not still
<a name="line29">using a resources or waiting for an event or signal that might still occur.</a>

    NOTE:
    -----
    Certain resources, such as signals and created ports, must be
    allocated and deallocated by the same task that will wait on them.
    Also note that if your subtask code is part of your loaded program,
    you must not allow your program to exit before its subtasks have
    cleaned up their allocations, and have been either deleted or placed
    in a safe state such as <a href="../Libraries_Manual_guide/node02D4.html">Wait</a>(0L).
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
