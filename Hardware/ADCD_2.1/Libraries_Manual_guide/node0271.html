<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="Libraries/Lib_15" NODE="15-3-12-1" TITLE="15 / / Other Functions / GT_FilterIMsg() and GT_PostFilterIMsg()" INDEX="Libraries/Lib_Index/MAIN" -->
<head>
<title>15 / / Other Functions / GT_FilterIMsg() and GT_PostFilterIMsg()</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<a href="../Libraries_Manual_guide/node002C.html"><img src="../images/index.gif" alt="[Index]" border=0></a>
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Libraries_Manual_guide/node0270.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Libraries_Manual_guide/node0272.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->
For most GadTools programs, <a href="../Libraries_Manual_guide/node025B.html">GT_GetIMsg()</a> and <a href="../Libraries_Manual_guide/node025B.html">GT_ReplyIMsg()</a> work perfectly
well.  In rare cases an application may find they pose a bit of a problem.
A typical case is when all messages are supposed to go through a
centralized <a href="../Libraries_Manual_guide/node02F3.html">ReplyMsg()</a> that cannot be converted to a GT_ReplyIMsg().
Since calls to GT_GetIMsg() and GT_ReplyIMsg() must be paired, there would
<a name="line7">be a problem.</a>

For such cases, the <a href="../Includes_and_Autodocs_2._guide/node03F1.html">GT_FilterIMsg()</a> and <a href="../Includes_and_Autodocs_2._guide/node03F3.html">GT_PostFilterIMsg()</a> functions are
available.  These functions allow <a href="../Libraries_Manual_guide/node02F2.html">GetMsg()</a> and <a href="../Libraries_Manual_guide/node02F3.html">ReplyMsg()</a> to be used in a
way that is compatible with GadTools.

    Warning:
    --------
    These functions are for specialized use only and will not be used by
    the majority of applications.  See <a href="../Libraries_Manual_guide/node025B.html">GT_GetIMsg()</a> and
    <a href="../Libraries_Manual_guide/node025B.html">GT_ReplyIMsg()</a> for standard message handling.


    struct IntuiMessage *GT_FilterIMsg( struct IntuiMessage *imsg );
    struct IntuiMessage *GT_PostFilterIMsg( struct IntuiMessage *imsg );

The <a href="../Includes_and_Autodocs_2._guide/node03F1.html">GT_FilterIMsg()</a> function should be called right after <a href="../Libraries_Manual_guide/node02F2.html">GetMsg()</a>.  It
takes a pointer to the original <a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a> and, if the message applies
to a GadTools gadget, returns either a modified IntuiMessage or a NULL.  A
NULL return signifies that the message was consumed by a GadTools gadget
(and not needed by the application).

The <a href="../Includes_and_Autodocs_2._guide/node03F3.html">GT_PostFilterIMsg()</a> function should be called before replying to any
message modified by <a href="../Includes_and_Autodocs_2._guide/node03F1.html">GT_FilterIMsg()</a>.  It takes a pointer to the modified
version of an <a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a> obtained with GT_FilterIMsg() and returns a
pointer to the original IntuiMessage.

The typical calling sequence for a program that uses these functions, is
to call <a href="../Libraries_Manual_guide/node02F2.html">GetMsg()</a> to get the <a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a>.  Then, if the message applies to
a window which contains GadTools gadgets, call <a href="../Includes_and_Autodocs_2._guide/node03F1.html">GT_FilterIMsg()</a>.  Any
message returned by GT_FilterIMsg() should be used like a message returned
from <a href="../Libraries_Manual_guide/node025B.html">GT_GetIMsg()</a>.

When done with the message, the application must call <a href="../Includes_and_Autodocs_2._guide/node03F3.html">GT_PostFilterIMsg()</a>
to perform any clean up necessitated by the previous call to
<a href="../Includes_and_Autodocs_2._guide/node03F1.html">GT_FilterIMsg()</a>.  In all cases, the application must then reply the
original <a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a> using <a href="../Libraries_Manual_guide/node02F3.html">ReplyMsg()</a>.  This is true even for consumed
messages as these are not replied by GadTools.  For example, the
<a name="line45">application could use code such as this:</a>

    /* port is a message port receiving different messages */
    /* gtwindow is the window that contains GadTools gadgets */

    imsg = GetMsg(port);

    /* Is this the window with GadTools gadgets? */
    if (imsg-&#062;IDCMPWindow == gtwindow)
        {
        /* Filter the message and see if action is needed */
        if (gtimsg = GT_FilterIMsg(imsg))
            {
            switch (gtimsg-&#062;Class)
                {
                /* Act depending on the message */
                ...
                }
            /* Clean up the filtered message.  The return value is not */
            /* needed since we already have a pointer to the original  */
            /* message.                                                */
            GT_PostFilterIMsg(gtimsg);
            }
        }
    /* other stuff can go here */
    ReplyMsg(imsg);

You should not make any assumptions about the contents of the unfiltered
<a href="../Libraries_Manual_guide/node01D9.html">IntuiMessage</a> (imsg in the above example).  Only two things are guaranteed:
the unfiltered IntuiMessage must be replied to and the unfiltered
IntuiMessage (if it produces anything when passed through <a href="../Includes_and_Autodocs_2._guide/node03F1.html">GT_FilterIMsg()</a>)
will produce a meaningful GadTools IntuiMessage like those described in
the section on the different <a href="../Libraries_Manual_guide/node025F.html">kinds of gadgets</a>.  The relationship between
the unfiltered and filtered messages are expected to change in the future.
See the section on <a href="../Libraries_Manual_guide/node0277.html">documented side-effects</a> for more information.
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
