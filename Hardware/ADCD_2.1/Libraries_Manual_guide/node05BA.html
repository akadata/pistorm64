<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="Lib_examples/suits8.asm" NODE="MAIN" TITLE="Lib_examples/suits8.asm" -->
<head>
<title>Lib_examples/suits8.asm</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<img src="../images/index_d.gif" alt="[Index]">
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Libraries_Manual_guide/node05B9.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Libraries_Manual_guide/node05BB.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->
* A sparse (but complete) sample font.
*
* 1.  Assemble this file (assumed to have been saved as &#034;suits8.asm&#034;). For
* example, if you have the CAPE 680x0 assembler, and you have assigned
* &#034;include:&#034; to the directory containing your include files, use:
*          CAsm -a &#034;suits8.asm&#034; -o &#034;suits8.o&#034; -i &#034;include:&#034;
*
*     Link &#034;suits8.o&#034;.  For example, if you have Lattice, use:
*          BLink from &#034;suits8.o&#034; to &#034;suits8&#034;
*
* 2.  Create the subdirectory &#034;Fonts:suits&#034;.  Copy the file &#034;suits8&#034;
*     (created in step 1) to &#034;Fonts:suits/8&#034;.
*
* 3.  Create a font contents file for the font.  You can do this by two
*      methods:
*
*   a. Run the program &#034;System/FixFonts&#034; which will create the file
*      &#034;Fonts:suits.font&#034; automatically.
*   b. Use the NewFontContents() call in the diskfont library to create a
*      FontContentsHeader structure, which can be saved in the Fonts:
*      directory as &#034;suits.font&#034;.   This is essentially what FixFonts does.
*
* The next word contains the font YSize; in this case, 0x0008.
*
* The next byte contains the font Flags, in this case 0x00.
*
* The last byte contains the font characteristics, in this case 0x60.  This
* says it is a disk-based font (bit 1 set) and the font has been removed
* (bit 7 set), saying that the font is not currently resident.
*
* Summary of suits.font file:
*
* Name: fch_FileID fch_NumEntries fc_FileName    fc_YSize fc_Flags fc_Style
* Size: word       word     MAXFONTPATH bytes word     byte     byte
* Hex:  0f00       0001     73756974732F3800  0008     00       60
* ASCII:            s u i t s / 8 \0
*
* The correct length of a font file may be calculated with this formula:
* length = ((number of font contents entries) * (MAXFONTPATH+4)) + 4. In
* this case (one entry), this becomes (MAXFONTPATH + 8) or 264.
*
* To try out this example font, do the following.  Use the Fonts
* Preferences editor or a program that allows the user to select fonts.
* Choose the &#034;suits&#034; font in size 8.  This example font defines ASCII
* characters 'a' 'b' 'c' and 'd' only. All other characters map to a
* rectangle, meaning &#034;character unknown&#034;.

    INCLUDE  &#034;exec/types.i&#034;
    INCLUDE  &#034;exec/nodes.i&#034;
    INCLUDE  &#034;libraries/diskfont.i&#034;

    MOVEQ  #-1,D0    ; Provide an easy exit in case this file is
    RTS              ; &#034;Run&#034; instead of merely loaded.

    DC.L   0         ; ln_Succ   * These five entries comprise a Node
    DC.L   0         ; ln_Pred   * structure, used by the system to link
    DC.B   NT_FONT   ; ln_Type   * disk fonts into a list.  See the
    DC.B   0         ; ln_Pri    * definition of the &#034;DiskFontHeader&#034;
    DC.L   fontName  ; ln_Name   * structure in the &#034;libraries/diskfont.i&#034;
                                 * includefile for more information.
    DC.W   DFH_ID    ; FileID
    DC.W   1         ; Revision
    DC.L   0         ; Segment

* The next MAXFONTNAME bytes are a placeholder.  The name of the font
* contents file (e.g. &#034;suits.font&#034;) will be copied here after this font
* descriptor is LoadSeg-ed into memory.  The Name field could have been
* left blank, but inserting the font name and size (or style) allows one to
* tell something about the font by using &#034;Type OPT H&#034; on the file.

fontName:
    DC.B      &#034;suits8&#034;    ; Name

* If your assembler needs an absolute value in place of the &#034;length&#034;
* variable, simply count the number of characters in Name and use that.

length  EQU     *-fontName           ; Assembler calculates Name's length.
        DCB.B   MAXFONTNAME-length,0 ; Padding of null characters.

font:
    DC.L  0          ; ln_Succ       * The rest of the information is a
    DC.L  0          ; ln_Pred       * TextFont structure.  See the
    DC.B  NT_FONT    ; ln_Type       * &#034;graphics/text.i&#034; include file for
    DC.B  0          ; ln_Pri        * more information.
    DC.L  fontName   ; ln_Name
    DC.L  0          ; mn_ReplyPort
    DC.W  0          ; (Reserved for 1.4 system use.)
    DC.W  8          ; tf_YSize
    DC.B  0          ; tf_Style
    DC.B  FPF_DESIGNED!FPF_PROPORTIONAL!FPF_DISKFONT ; tf_Flags
    DC.W  14         ; tf_XSize
    DC.W  6          ; tf_Baseline  &#060;----* tf_Baseline must be no greater
    DC.W  1          ; tf_BoldSmear      * than tf_YSize-1, otherwise
    DC.W  0          ; tf_Accessors      * algorithmically-generated styles
    DC.B  97         ; tf_LoChar         * (italic in particular) can
    DC.B  100        ; tf_HiChar         *  corrupt system memory.
    DC.L  fontData   ; tf_CharData
    DC.W  8          ; tf_Modulo  &#060;- * add this to the data pointer to go
                     ;               * from one row of a character to the
                                     * next row of it.
    DC.L  fontLoc    ; tf_CharLoc &#060;------* bit position in the font data
    DC.L  fontSpace  ; tf_CharSpace      * at which the character begins.
    DC.L  fontKern   ; tf_CharKern

* The four characters of this font define the four playing-card suit
* symbols.  The heart, club, diamond, and spade map to the lower-case ASCII
* characters 'a', 'b', 'c', and 'd' respectively The fifth entry in the
* table is the character to be output when there is no entry defined in the
* character set for the requested ASCII value.  Font data is bit-packed
* edge to edge to save space.

fontData:                             ;   97 (a)       98 (b)       99 (c)   100 (d)      255
    DC.W  $071C0,$08040,$070FF,$0F000 ; &#060;        X        X    X        X        &#062;
    DC.W  $0FBE3,$0E0E0,$0F8C0,$03000 ;  .@@@...@@@.  .....@.....  ...@...  ....@@@....  @@@@@@@@@@@@
    DC.W  $07FCF,$0F9F3,$026C0,$03000 ;  @@@@@.@@@@@  ...@@@@@...  ..@@@..  ...@@@@@...  @@........@@
    DC.W  $03F9F,$0FFFF,$0FFC0,$03000 ;  .@@@@@@@@@.  .@@@@@@@@@.  .@@@@@.  .@@..@..@@.  @@........@@
    DC.W  $01F0E,$0B9F3,$026C0,$03000 ;  ..@@@@@@@..  @@@@@@@@@@@  @@@@@@@  @@@@@@@@@@@  @@........@@
    DC.W  $00E00,$080E0,$020C0,$03000 ;  ...@@@@@...  .@@@.@.@@@.  .@@@@@.  .@@..@..@@.  @@........@@
    DC.W  $00403,$0E040,$0F8FF,$0F000 ;  ....@@@....  .....@.....  ..@@@..  .....@.....  @@........@@
    DC.W  $00000,$00000,$00000,$00000 ;  .....@.....  ...@@@@@...  ...@...  ...@@@@@...  @@@@@@@@@@@@
    DC.W  $00000,$00000,$00000,$00000 ;  ...........  ...........  .......  ...........  ............

fontLoc:              ; The fontLoc information is used to &#034;unpack&#034; the
    DC.L  $00000000B  ; fontData. Each pair of words specifies how the
    DC.L  $0000B000B  ; characters are bit-packed.  For example, the first
    DC.L  $000160007  ; character starts at bit position 0x0000, and is
    DC.L  $0001D000B  ; 0x000B (11) bits wide.  The second character starts
    DC.L  $00028000C  ; at bit position 0x000B and is 0x000B bits wide, and
                      ; so on.  This tellsthe font handler how to unpack
                      ; the bits from the array.

fontSpace:                      ; fontSpace array:  Use a space this wide
    DC.W  000012,000012         ; to contain this character when it is
    DC.W  000008,000012,000013  ; printed.  For reverse-path fonts these
                                ; values would be small or negative.

fontKern:                       ; fontKern array:  Place a space this wide
    DC.W  000001,000001         ; after the corresponding character to
    DC.W  000001,000001,000001  ; separate it from the following character.
                                ; For reverse-path fonts these values would
                                ; be large negative numbers, approximately
                                ; the width of the characters.
fontEnd:
    END
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
