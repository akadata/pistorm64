<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="Libraries/Lib_24" NODE="24-1" TITLE="24 Exec Messages and Ports / Message Ports" INDEX="Libraries/Lib_Index/MAIN" -->
<head>
<title>24 Exec Messages and Ports / Message Ports</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<a href="../Libraries_Manual_guide/node002C.html"><img src="../images/index.gif" alt="[Index]" border=0></a>
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Libraries_Manual_guide/node02EA.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Libraries_Manual_guide/node02EC.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->
Message ports are rendezvous points at which messages are collected. A
port may contain any number of outstanding messages from many different
originators.  When a message arrives at a port, the message is appended to
the end of the list of messages for that port, and a prespecified arrival
action is invoked.  This action may do nothing, or it may cause a
predefined task signal or software interrupt (see the &#034;<a href="../Libraries_Manual_guide/node0302.html">Exec Interrupts</a>&#034;
chapter).

Like many Exec structures, ports may be given a symbolic name.  Such names
are particularly useful for tasks that must rendezvous with dynamically
<a name="line12">created ports.  They are also useful for debugging purposes.</a>

A message port consists of a MsgPort structure as defined in the
&#060;exec/<a href="../Includes_and_Autodocs_2._guide/node0099.html#line27">ports.h</a>&#062; and &#060;exec/<a href="../Includes_and_Autodocs_2._guide/node009D.html#line23">ports.i</a>&#062; include files.  The C structure for a
port is as follows:

    struct MsgPort {
        struct Node  mp_Node;
        UBYTE        mp_Flags;
        UBYTE        mp_SigBit;
        void        *mp_SigTask;
        struct List  mp_MsgList;
    };

mp_Node
    is a standard <a href="../Libraries_Manual_guide/node02D9.html#line19">Node</a> structure.  This is useful for tasks that might
    want to rendezvous with a particular message port by name.

mp_Flags
    are used to indicate message arrival actions.  See the explanation
<a name="line32">    below.</a>

mp_SigBit
    is the signal bit number when a port is used with the task signal
<a name="line36">    arrival action.</a>

mp_SigTask
    is a pointer to the task to be signaled.  If a software interrupt
    arrival action is specified, this is a pointer to the interrupt
    structure.

mp_MsgList
    is the list header for all messages queued to this port.  (See the
<a name="line45">    &#034;<a href="../Libraries_Manual_guide/node02D8.html">Exec Lists and Queues</a>&#034; chapter).</a>

The mp_Flags field contains a subfield indicated by the PF_ACTION mask.
This sub-field specifies the message arrival action that occurs when a
<a name="line49">port receives a new message. The possibilities are as follows:</a>

PA_SIGNAL
    This flag tells Exec to signal the mp_SigTask using signal number
    mp_SigBit on the arrival of a new message.  Every time a message is
    put to the port another signal will occur regardless of how many
<a name="line55">    messages have been queued to the port.</a>

PA_SOFTINT
    This flag tells Exec to <a href="../Libraries_Manual_guide/node030D.html#line9">Cause()</a> a software interrupt when a message
    arrives at the port.  In this case, the mp_SigTask field must contain
    a pointer to a struct Interrupt rather than a Task pointer.  The
    software interrupt will be Caused every time a message is received.

PA_IGNORE
    This flag tells Exec to perform no operation other than queuing the
    message.  This action is often used to stop signaling or software
    interrupts without disturbing the contents of the mp_SigTask field.

It is important to realize that a port's arrival action will occur for
each new message queued, and that there is not a one-to-one correspondence
between messages and signals.  Task signals are only single-bit flags so
there is no record of how many times a particular signal occurred.  There
may be many messages queued and only a single task signal; sometimes
however there may be a signal, but no messages.  All of this has certain
implications when designing code that deals with these actions.  Your code
should not depend on receiving a signal for every message at your port.
All of this is also true for software interrupts.

 <a href="../Libraries_Manual_guide/node02EC.html">Creating a Message Port</a>    <a href="../Libraries_Manual_guide/node02EE.html">How To Rendezvous at a Message Port</a> 
 <a href="../Libraries_Manual_guide/node02ED.html">Deleting a Message Port</a> 
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
