<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="Includes/intuition/sghooks.h" NODE="MAIN" TITLE="Includes/intuition/sghooks.h" -->
<head>
<title>Includes/intuition/sghooks.h</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<img src="../images/index_d.gif" alt="[Index]">
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Includes_and_Autodocs_2._guide/node00E4.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Includes_and_Autodocs_2._guide/node00E6.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->
#ifndef INTUITION_SGHOOKS_H
#define INTUITION_SGHOOKS_H TRUE
/*
**  $Filename: intuition/sghooks.h $
**  $Release: 2.04 Includes, V37.4 $
**  $Revision: 36.5 $
**  $Date: 91/11/08 $
**
**  string gadget extensions and hooks
**
**  (C) Copyright 1988-1999 Amiga, Inc.
**	    All Rights Reserved
*/
<a name="line14"></a>
#ifndef EXEC_TYPES_H
#include &#060;exec/types.h&#062;
#endif
<a name="line18"></a>
struct StringExtend {
<a name="line20">    /* display specifications	*/</a>
<a name="line21">    struct TextFont *Font;	/* must be an open Font (not TextAttr)	*/</a>
<a name="line22">    UBYTE	Pens[2];	/* color of text/backgroun		*/</a>
    UBYTE	ActivePens[2];	/* colors when gadget is active		*/

<a name="line25">    /* edit specifications	*/</a>
<a name="line26">    ULONG	InitialModes;	/* initial mode flags, below		*/</a>
<a name="line27">    struct Hook *EditHook;	/* if non-NULL, must supply WorkBuffer	*/</a>
    UBYTE	*WorkBuffer;	/* must be as large as StringInfo.Buffer*/
<a name="line29"></a>
    ULONG	Reserved[4];	/* set to 0				*/
};
<a name="line32"></a>
struct SGWork	{
<a name="line34">    /* set up when gadget is first activated	*/</a>
<a name="line35">    struct Gadget	*Gadget;	/* the contestant itself	*/</a>
<a name="line36">    struct StringInfo	*StringInfo;	/* easy access to sinfo		*/</a>
<a name="line37">    UBYTE		*WorkBuffer;	/* intuition's planned result	*/</a>
<a name="line38">    UBYTE		*PrevBuffer;	/* what was there before	*/</a>
    ULONG		Modes;		/* current mode			*/

<a name="line41">    /* modified for each input event	*/</a>
<a name="line42">    struct InputEvent	*IEvent;	/* actual event: do not change	*/</a>
<a name="line43">    UWORD		Code;		/* character code, if one byte	*/</a>
<a name="line44">    WORD		BufferPos;	/* cursor position		*/</a>
<a name="line45">    WORD		NumChars;</a>
<a name="line46">    ULONG		Actions;	/* what Intuition will do	*/</a>
    LONG		LongInt;	/* temp storage for longint	*/
<a name="line48"></a>
<a name="line49">    struct GadgetInfo	*GadgetInfo;	/* see cghooks.h		*/</a>
    UWORD		EditOp;		/* from constants below		*/
};

/* SGWork.EditOp -
 * These values indicate what basic type of operation the global
 * editing hook has performed on the string before your gadget's custom
 * editing hook gets called.  You do not have to be concerned with the
 * value your custom hook leaves in the EditOp field, only if you
 * write a global editing hook.
 *
 * For most of these general edit operations, you'll want to compare
 * the BufferPos and NumChars of the StringInfo (before global editing)
 * and SGWork (after global editing).
 */
<a name="line64"></a>
#define EO_NOOP		(0x0001)
<a name="line66">	/* did nothing							*/</a>
#define EO_DELBACKWARD	(0x0002)
<a name="line68">	/* deleted some chars (maybe 0).				*/</a>
#define EO_DELFORWARD	(0x0003)
<a name="line70">	/* deleted some characters under and in front of the cursor	*/</a>
#define EO_MOVECURSOR	(0x0004)
<a name="line72">	/* moved the cursor						*/</a>
#define EO_ENTER	(0x0005)
<a name="line74">	/* &#034;enter&#034; or &#034;return&#034; key, terminate				*/</a>
#define EO_RESET	(0x0006)
<a name="line76">	/* current Intuition-style undo					*/</a>
#define EO_REPLACECHAR	(0x0007)
<a name="line78">	/* replaced one character and (maybe) advanced cursor		*/</a>
#define EO_INSERTCHAR	(0x0008)
<a name="line80">	/* inserted one char into string or added one at end		*/</a>
#define EO_BADFORMAT	(0x0009)
<a name="line82">	/* didn't like the text data, e.g., Bad LONGINT			*/</a>
#define EO_BIGCHANGE	(0x000A)	/* unused by Intuition	*/
<a name="line84">	/* complete or major change to the text, e.g. new string	*/</a>
#define EO_UNDO		(0x000B)	/* unused by Intuition	*/
<a name="line86">	/* some other style of undo					*/</a>
#define EO_CLEAR	(0x000C)
<a name="line88">	/* clear the string						*/</a>
#define EO_SPECIAL	(0x000D)	/* unused by Intuition	*/
	/* some operation that doesn't fit into the categories here	*/


<a name="line93">/* Mode Flags definitions (ONLY first group allowed as InitialModes)	*/</a>
#define SGM_REPLACE	(1L &#060;&#060; 0)	/* replace mode			*/
/* please initialize StringInfo with in-range value of BufferPos
 * if you are using SGM_REPLACE mode.
 */
<a name="line98"></a>
#define SGM_FIXEDFIELD	(1L &#060;&#060; 1)	/* fixed length buffer		*/
<a name="line100">					/* always set SGM_REPLACE, too	*/</a>
#define SGM_NOFILTER	(1L &#060;&#060; 2)	/* don't filter control chars	*/

<a name="line103">/* SGM_EXITHELP is new for V37, and ignored by V36: */</a>
#define SGM_EXITHELP	(1L &#060;&#060; 7)	/* exit with code = 0x5F if HELP hit */


<a name="line107">/* These Mode Flags are for internal use only				*/</a>
<a name="line108">#define SGM_NOCHANGE	(1L &#060;&#060; 3)	/* no edit changes yet		*/</a>
<a name="line109">#define SGM_NOWORKB	(1L &#060;&#060; 4)	/* Buffer == PrevBuffer		*/</a>
<a name="line110">#define SGM_CONTROL	(1L &#060;&#060; 5)	/* control char escape mode	*/</a>
#define SGM_LONGINT	(1L &#060;&#060; 6)	/* an intuition longint gadget	*/

<a name="line113">/* String Gadget Action Flags (put in SGWork.Actions by EditHook)	*/</a>
<a name="line114">#define SGA_USE		(0x1L)	/* use contents of SGWork		*/</a>
<a name="line115">#define SGA_END		(0x2L)	/* terminate gadget, code in Code field	*/</a>
<a name="line116">#define SGA_BEEP	(0x4L)	/* flash the screen for the user	*/</a>
<a name="line117">#define SGA_REUSE	(0x8L)	/* reuse input event			*/</a>
#define SGA_REDISPLAY	(0x10L)	/* gadget visuals changed		*/

<a name="line120">/* New for V37: */</a>
<a name="line121">#define SGA_NEXTACTIVE	(0x20L)	/* Make next possible gadget active.	*/</a>
#define SGA_PREVACTIVE	(0x40L)	/* Make previous possible gadget active.*/

/* function id for only existing custom string gadget edit hook	*/
<a name="line125"></a>
<a name="line126">#define SGH_KEY		(1L)	/* process editing keystroke		*/</a>
#define SGH_CLICK	(2L)	/* process mouse click cursor position	*/

/* Here's a brief summary of how the custom string gadget edit hook works:
 *	You provide a hook in StringInfo.Extension.EditHook.
 *	The hook is called in the standard way with the 'object'
 *	a pointer to SGWork, and the 'message' a pointer to a command
 *	block, starting either with (longword) SGH_KEY, SGH_CLICK,
 *	or something new.
 *
 *	You return 0 if you don't understand the command (SGH_KEY is
 *	required and assumed).	Return non-zero if you implement the
 *	command.
 *
 *   SGH_KEY:
 *	There are no parameters following the command longword.
 *
 *	Intuition will put its idea of proper values in the SGWork
 *	before calling you, and if you leave SGA_USE set in the
 *	SGWork.Actions field, Intuition will use the values
 *	found in SGWork fields WorkBuffer, NumChars, BufferPos,
 *	and LongInt, copying the WorkBuffer back to the StringInfo
 *	Buffer.
 *
 *	NOTE WELL: You may NOT change other SGWork fields.
 *
 *	If you clear SGA_USE, the string gadget will be unchanged.
 *
 *	If you set SGA_END, Intuition will terminate the activation
 *	of the string gadget.  If you also set SGA_REUSE, Intuition
 *	will reuse the input event after it deactivates your gadget.
 *
 *	In this case, Intuition will put the value found in SGWork.Code
 *	into the IntuiMessage.Code field of the IDCMP_GADGETUP message it
 *	sends to the application.
 *
 *	If you set SGA_BEEP, Intuition will call DisplayBeep(); use
 *	this if the user has typed in error, or buffer is full.
 *
 *	Set SGA_REDISPLAY if the changes to the gadget warrant a
 *	gadget redisplay.  Note: cursor movement requires a redisplay.
 *
 *	Starting in V37, you may set SGA_PREVACTIVE or SGA_NEXTACTIVE
 *	when you set SGA_END.  This tells Intuition that you want
 *	the next or previous gadget with GFLG_TABCYCLE to be activated.
 *
 *   SGH_CLICK:
 *	This hook command is called when Intuition wants to position
 *	the cursor in response to a mouse click in the string gadget.
 *
 *	Again, here are no parameters following the command longword.
 *
 *	This time, Intuition has already calculated the mouse position
 *	character cell and put it in SGWork.BufferPos.	The previous
 *	BufferPos value remains in the SGWork.StringInfo.BufferPos.
 *
 *	Intuition will again use the SGWork fields listed above for
 *	SGH_KEY.  One restriction is that you are NOT allowed to set
 *	SGA_END or SGA_REUSE for this command.	Intuition will not
 *	stand for a gadget which goes inactive when you click in it.
 *
 *	You should always leave the SGA_REDISPLAY flag set, since Intuition
 *	uses this processing when activating a string gadget.
 */

#endif
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
