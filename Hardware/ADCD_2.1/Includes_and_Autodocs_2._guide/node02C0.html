<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="AutoDocs/dos" NODE="InternalLoadSeg()" TITLE="dos.library/InternalLoadSeg" -->
<head>
<title>dos.library/InternalLoadSeg</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<img src="../images/index_d.gif" alt="[Index]">
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Includes_and_Autodocs_2._guide/node02BF.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Includes_and_Autodocs_2._guide/node02C1.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->

NAME
    InternalLoadSeg -- Low-level load routine (V36)

SYNOPSIS
    seglist = InternalLoadSeg(fh,table,functionarray,stack)
    D0                        D0  A0        A1        A2

    BPTR InternalLoadSeg(BPTR,BPTR,LONG *,LONG *)

FUNCTION
    Loads from fh.  Table is used when loading an overlay, otherwise
    should be NULL.  Functionarray is a pointer to an array of functions.
    Note that the current Seek position after loading may be at any point
    after the last hunk loaded.  The filehandle will not be closed.  If a
    stacksize is encoded in the file, the size will be stuffed in the
    LONG pointed to by stack.  This LONG should be initialized to your
    default value: InternalLoadSeg() will not change it if no stacksize
    is found. Clears unused portions of Code and Data hunks (as well as
    BSS hunks).  (This also applies to <a href="../Includes_and_Autodocs_2._guide/node02C5.html">LoadSeg()</a> and <a href="../Includes_and_Autodocs_2._guide/node02D4.html">NewLoadSeg()</a>).

    If the file being loaded is an overlaid file, this will return
    -(seglist).  All other results will be positive.

    NOTE to overlay users: InternalLoadSeg() does NOT return seglist in
    both D0 and D1, as <a href="../Includes_and_Autodocs_2._guide/node02C5.html">LoadSeg</a> does.  The current ovs.asm uses <a href="../Includes_and_Autodocs_2._guide/node02C5.html">LoadSeg()</a>,
    and assumes returns are in D1.  We will support this for <a href="../Includes_and_Autodocs_2._guide/node02C5.html">LoadSeg()</a>
    ONLY.

INPUTS
    fh            - Filehandle to load from.
    table         - When loading an overlay, otherwise ignored.
    functionarray - Array of function to be used for read, alloc, and free.
       FuncTable[0] -&#062;  Actual = ReadFunc(readhandle,buffer,length),DOSBase
                        D0                D1         A0     D0      A6
       FuncTable[1] -&#062;  Memory = AllocFunc(size,flags), Execbase
                        D0                 D0   D1      a6
       FuncTable[2] -&#062;  FreeFunc(memory,size), Execbase
                                 A1     D0     a6
    stack         - Pointer to storage (ULONG) for stacksize.

RESULT
    seglist       - Seglist loaded or NULL.  NOT returned in D1!

BUGS
    Really should use tags.

SEE ALSO
    <a href="../Includes_and_Autodocs_2._guide/node02C5.html">LoadSeg()</a>, <a href="../Includes_and_Autodocs_2._guide/node0306.html">UnLoadSeg()</a>, <a href="../Includes_and_Autodocs_2._guide/node02D4.html">NewLoadSeg()</a>, <a href="../Includes_and_Autodocs_2._guide/node02C1.html">InternalUnLoadSeg()</a>
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
