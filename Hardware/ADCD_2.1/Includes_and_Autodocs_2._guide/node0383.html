<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="AutoDocs/exec" NODE="SumKickData()" TITLE="exec.library/SumKickData" -->
<head>
<title>exec.library/SumKickData</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<img src="../images/index_d.gif" alt="[Index]">
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Includes_and_Autodocs_2._guide/node0382.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Includes_and_Autodocs_2._guide/node0384.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->

NAME
    SumKickData -- compute the checksum for the Kickstart delta list

SYNOPSIS
    checksum = SumKickData()
    D0

    ULONG SumKickData(void);

FUNCTION
    The Amiga system has some ROM (or Kickstart) resident code that
    provides the basic functions for the machine.  This code is
    unchangeable by the system software.  This function is part of a
    support system to modify parts of the ROM.

    The ROM code is linked together at run time via ROMTags (also known
    as <a href="../Includes_and_Autodocs_2._guide/node00A0.html#line19">Resident</a> structures, defined in <a href="../Includes_and_Autodocs_2._guide/node00A0.html">exec/resident.h)</a>.  These tags tell
    Exec's low level boot code what subsystems exist in which regions of
    memory.  The current list of ROMTags is contained in the ResModules
    field of <a href="../Includes_and_Autodocs_2._guide/node009E.html#line35">ExecBase</a>.  By default this list contains any ROMTags found
    in the address ranges $F80000-$FFFFFF and $F00000-$F7FFFF.

    There is also a facility to selectively add or replace modules to the
    ROMTag list.  These modules can exist in RAM, and the memory they
    occupy will be deleted from the memory free list during the boot
    process.  SumKickData() plays an important role in this run-time
    modification of the ROMTag array.

    Three variables in <a href="../Includes_and_Autodocs_2._guide/node009E.html#line35">ExecBase</a> are used in changing the ROMTag array:
    KickMemPtr, KickTagPtr, and KickCheckSum. KickMemPtr points to a
    linked list of <a href="../Includes_and_Autodocs_2._guide/node0089.html#line41">MemEntry</a> structures. The memory that these <a href="../Includes_and_Autodocs_2._guide/node0089.html#line41">MemEntry</a>
    structures reference will be allocated (via AllocAbs) at boot time.
    The <a href="../Includes_and_Autodocs_2._guide/node0089.html#line41">MemEntry</a> structure itself must also be in the list.

    KickTagPtr points to a long-word array of the same format as the
    ResModules array.  The array has a series of pointers to ROMTag
    structures.  The array is either NULL terminated, or will have an
    entry with the most significant bit (bit 31) set.  The most
    significant bit being set says that this is a link to another
    long-word array of ROMTag entries.  This new array's address can be
    found by clearing bit 31.

    KickCheckSum has the result of SumKickData().  It is the checksum of
    both the KickMemPtr structure and the KickTagPtr arrays.  If the
    checksum does not compute correctly then both KickMemPtr and
    KickTagPtr will be ignored.

    If all the memory referenced by KickMemPtr can't be allocated then
    KickTagPtr will be ignored.

    There is one more important caveat about adding ROMTags. All this
    ROMTag magic is run very early on in the system -- before expansion
    memory is added to the system. Therefore any memory in this
    additional ROMTag area must be addressable at this time. This means
    that your ROMTag code, <a href="../Includes_and_Autodocs_2._guide/node0089.html#line41">MemEntry</a> structures, and resident arrays
    cannot be in expansion memory.  There are two regions of memory that
    are acceptable:  one is chip memory, and the other is &#034;Ranger&#034; memory
    (memory in the range between $C00000-$D80000).

    <a href="../Includes_and_Autodocs_2._guide/node00D4.html#line1233">Remember</a> that changing an existing ROMTag entry falls into the
    &#034;heavy magic&#034; category -- be very careful when doing it.  The odd are
    that you will blow yourself out of the water.

NOTE
    SumKickData was introduced in the 1.2 release

RESULT
    Value to be stuffed into ExecBase-&#062;KickCheckSum.

WARNING
    After writing to KickCheckSum, you should push the data cache.
    This prevents potential problems with large copyback style caches.
    A call to <a href="../Includes_and_Autodocs_2._guide/node0339.html">CacheClearU</a> will do fine.

SEE ALSO
    <a href="../Includes_and_Autodocs_2._guide/node035C.html">InitResident</a>, <a href="../Includes_and_Autodocs_2._guide/node0350.html">FindResident</a>
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
