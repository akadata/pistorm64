<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/39.2 FILE="cd" NODE="CD_READXL" TITLE="cd.device/CD_READXL" -->
<head>
<title>cd.device/CD_READXL</title>
</head>
<body text="#000000" bgcolor="#AAAAAA">
<img src="../images/toc_d.gif" alt="[Contents]">
<img src="../images/index_d.gif" alt="[Index]">
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Includes_and_Autodocs_3._guide/node00B2.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Includes_and_Autodocs_3._guide/node00B4.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->

<b>   NAME</b>
       CD_READXL -- <a href="../Includes_and_Autodocs_3._guide/node01A0.html">Read</a> from CD-ROM into memory via transfer list.

<b>   IO REQUEST</b>
       io_Device       preset by the call to <a href="../Includes_and_Autodocs_3._guide/node00BB.html">OpenDevice()</a>
       io_Unit         preset by the call to <a href="../Includes_and_Autodocs_3._guide/node00BB.html">OpenDevice()</a>
       io_Command      CD_READXL
       io_Data         pointer to transfer list (i.e. struct <a href="../Includes_and_Autodocs_3._guide/node0628.html#line19">List</a> *).
       io_Length       maximum transfer length (WORD multiple) or 0.
       io_Offset       byte offset from the start of the disk describing
                       where to read data from, must be a WORD multiple.

<b>   RESULTS</b>
       io_Error        0 for success, or an error code as described in
                       <a href="../Includes_and_Autodocs_3._guide/node05E4.html">&#060;devices/cd.h&#062;</a>
       io_Actual       if io_Error is 0, number of bytes actually transferred

<b>   FUNCTION</b>
       This command starts reading data off the disk at the specified
       location and deposits it into memory according to the nodes in a
       transfer list.  The pointer to the list of transfer nodes is placed
       in io_Data.  If you have a non-circular transfer list, simply set
       io_Length to 0 (0 is special and means ignore io_Length) -- your
       transfer will end when your transfer list has been exhausted.  If you
       have a circular transfer list, the list will never end.  In this case,
       the transfer will terminate when io_Length bytes have been
       transferred.

       The fields in the <a href="../Includes_and_Autodocs_3._guide/node05E4.html#line225">CDXL</a> node structure are:

       struct  <a href="../Includes_and_Autodocs_3._guide/node05E4.html#line225">CDXL</a> {

           struct <a href="../Includes_and_Autodocs_3._guide/node062F.html#line30">MinNode</a>  Node;         /* double linkage                */
           char           *Buffer;       /* data destination              */
           <a href="../Includes_and_Autodocs_3._guide/node0654.html#line39">LONG</a>            Length;       /* must be even # bytes          */
           <a href="../Includes_and_Autodocs_3._guide/node0654.html#line39">LONG</a>            Actual;       /* bytes transferred             */
           <a href="../Includes_and_Autodocs_3._guide/node0654.html#line37">APTR</a>            IntData;      /* interrupt server data segment */
           VOID            (*IntCode)(); /* interrupt server code entry   */
           };

       The philosophy here is that you set up the buffers you want filled,
       create <a href="../Includes_and_Autodocs_3._guide/node05E4.html#line225">CDXL</a> nodes describing the locations and sizes of these
       buffers, link all the nodes together in the order that you'd like
       (even make a circular list for animations), and execute the command.
       The data will be streamed into the appropriate buffers until the
       list has been exhausted, an entry with a Length of zero is
       encountered, io_Length bytes have been transferred (if io_Length is
       non-zero), or the command is aborted with <a href="../Includes_and_Autodocs_3._guide/node0574.html">AbortIO()</a>.

       If you fill in the (*IntCode)() field with a pointer to an interrupt
       routine, your routine will be called when the transfer for the node
       is complete.  Your code will be called before the driver proceeds to
       the next node.  The interrupt should follow the same rules as standard
       interrupts (see <a href="../Includes_and_Autodocs_3._guide/node01DA.html">AddIntServer</a> of Exec autodocs).  Register A2 will
       contain a pointer to the node just completed.  You may manipulate the
       list from within the interrupt. Your code must be brief (this is an
       interrupt).  When returning from this interrupt, D0 should be cleared
       and an RTS instruction should be used to return.

       Servers are called with the following register conventions:

           D0 - scratch
           D1 - scratch

           A0 - scratch
           A1 - server is_Data pointer (scratch)
           A2 - pointer to <a href="../Includes_and_Autodocs_3._guide/node05E4.html#line225">CDXL</a> node just completed

           A5 - jump vector register (scratch)

           all other registers must be preserved

<b>   EXAMPLE</b>

<b>   NOTES</b>
       Try to make sure that small buffers are not overused.  Each time
       a node is completed, an interrupt is generated.  If you find that
       your computer is acting sluggish, or the CD_READXL command is
       aborting, you are probably generating too many interrupts.  It is
       not efficient to have more than a few of these interrupts generated
       within a vertical blank.

       Unlike the READ command, the READXL command will not retry a sector
       if there is an error.  Since the READXL command's purpose is primarily
       for animations, data streaming is considered more important than the
       data itself.  An error will be returned in io_Error if a data error
       did occur.  This command will never drop to a lower speed in the event
       of an error.

<b>   BUGS</b>

<b>   SEE ALSO</b>
       <a href="../Includes_and_Autodocs_3._guide/node057F.html">CMD_READ</a>, <a href="../Includes_and_Autodocs_3._guide/node00B7.html">CD_SEEK</a>, Autodocs - <a href="../Includes_and_Autodocs_3._guide/node01DA.html">AddIntServer</a>
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
