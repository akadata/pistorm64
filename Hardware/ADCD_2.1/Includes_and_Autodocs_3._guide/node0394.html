<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/39.2 FILE="intuition" NODE="AllocRemember()" TITLE="intuition.library/AllocRemember" -->
<head>
<title>intuition.library/AllocRemember</title>
</head>
<body text="#000000" bgcolor="#AAAAAA">
<img src="../images/toc_d.gif" alt="[Contents]">
<img src="../images/index_d.gif" alt="[Index]">
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Includes_and_Autodocs_3._guide/node0393.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Includes_and_Autodocs_3._guide/node0395.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->

<b>    NAME</b>
	AllocRemember -- <a href="../Includes_and_Autodocs_3._guide/node01E7.html">AllocMem()</a> with tracking to make freeing easy.

<b>    SYNOPSIS</b>
	MemBlock = AllocRemember( RememberKey, Size, Flags )
	D0			  A0	       D0    D1

	<a href="../Includes_and_Autodocs_3._guide/node0654.html#line37">APTR</a> AllocRemember( struct <a href="../Includes_and_Autodocs_3._guide/node05E0.html#line1429">Remember</a> **, ULONG, ULONG );

<b>    FUNCTION</b>
	This routine calls the Exec <a href="../Includes_and_Autodocs_3._guide/node01E7.html">AllocMem()</a> function for you, but also links
	the parameters of the allocation into a master list, so that
	you can simply call the Intuition routine <a href="../Includes_and_Autodocs_3._guide/node03B0.html">FreeRemember()</a> at a later
	time to deallocate all allocated memory without being required to
	remember the details of the memory you've allocated.

	This routine will have two primary uses:
       -   Let's say that you're doing a long series of allocations in a
           procedure.  If any one of the allocations fails, your program
	    may need to abort the procedure.  Abandoning ship correctly
	    involves freeing up what memory you've already allocated.  This
	    procedure allows you to free up that memory easily, without being
	    required to keep track of how many allocations you've already done,
	    what the sizes of the allocations were, or where the memory was
	    allocated.

       -   Also, in the more general case, you may do all of the allocations
           in your entire program using this routine.  Then, when your
           program is exiting, you can free it all up at once with a
           simple call to <a href="../Includes_and_Autodocs_3._guide/node03B0.html">FreeRemember()</a>.

	You create the &#034;anchor&#034; for the allocation master list by creating
	a variable that's a pointer to struct <a href="../Includes_and_Autodocs_3._guide/node05E0.html#line1429">Remember</a>, and initializing
	that pointer to NULL.  This is called the RememberKey.  Whenever
	you call AllocRemember(), the routine actually does two memory
	allocations, one for the memory you want and the other for a copy
	of a <a href="../Includes_and_Autodocs_3._guide/node05E0.html#line1429">Remember</a> structure.  The <a href="../Includes_and_Autodocs_3._guide/node05E0.html#line1429">Remember</a> structure is filled in
	with data describing your memory allocation, and it's linked
	into the master list pointed to by your RememberKey.  Then, to
	free up any memory that's been allocated, all you have to do is
	call <a href="../Includes_and_Autodocs_3._guide/node03B0.html">FreeRemember()</a> with your RememberKey.

	Please read the <a href="../Includes_and_Autodocs_3._guide/node03B0.html">FreeRemember()</a> function description, too.  As you will
	see, you can select either to free just the link nodes and keep all the
	allocated memory for yourself, or to free both the nodes and your memory
	buffers.


<b>    INPUTS</b>
	RememberKey = the address of a pointer to struct <a href="../Includes_and_Autodocs_3._guide/node05E0.html#line1429">Remember</a>.  Before the
	very first call to AllocRemember, initialize this pointer to NULL.

	Size = the size in bytes of the memory allocation.  Please refer to the
	    <a href="../Includes_and_Autodocs_3._guide/node01E7.html">exec.library/AllocMem()</a> function for details.
	Flags = the specifications for the memory allocation.  Please refer to
	    the <a href="../Includes_and_Autodocs_3._guide/node01E7.html">exec.library/AllocMem()</a> function for details.

<b>    EXAMPLE</b>
	struct <a href="../Includes_and_Autodocs_3._guide/node05E0.html#line1429">Remember</a> *RememberKey;
	RememberKey = NULL;
	buffer = AllocRemember(&#038;RememberKey, BUFSIZE, MEMF_CHIP);
	if (buffer)
	{
	    /* Use the buffer */
	    ...
	}
	FreeRemember(&#038;RememberKey, TRUE);

<b>    RESULT</b>
	If the memory allocation is successful, this routine returns the byte
	address of your requested memory block.  Also, the node to your block
	will be linked into the list pointed to by your RememberKey variable.
	If the allocation fails, this routine returns NULL and the list pointed
	to by RememberKey, if any, will be unchanged.

<b>    BUGS</b>
	This function makes two allocations for each memory buffer
	you request.  This is neither fast nor good for memory
	fragmentation.

	This function should use the exec AllocPool() function internally,
	at least for the <a href="../Includes_and_Autodocs_3._guide/node05E0.html#line1429">Remember</a> headers.

<b>    SEE ALSO</b>
	<a href="../Includes_and_Autodocs_3._guide/node03B0.html">FreeRemember()</a>, <a href="../Includes_and_Autodocs_3._guide/node01E7.html">exec.library/AllocMem()</a>
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
