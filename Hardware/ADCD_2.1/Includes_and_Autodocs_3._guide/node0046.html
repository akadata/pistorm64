<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/39.2 FILE="amiga_lib" NODE="LibFreePooled()" TITLE="amiga.lib/LibFreePooled" -->
<head>
<title>amiga.lib/LibFreePooled</title>
</head>
<body text="#000000" bgcolor="#AAAAAA">
<img src="../images/toc_d.gif" alt="[Contents]">
<img src="../images/index_d.gif" alt="[Index]">
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Includes_and_Autodocs_3._guide/node0045.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Includes_and_Autodocs_3._guide/node0047.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->

<b>    NAME</b>
	LibFreePooled -- Free pooled memory  (V33)

<b>    SYNOPSIS</b>
	LibFreePooled(poolHeader,memory,memSize)
		      a0         a1     d0

	void LibFreePooled(void *,void *,ULONG);

<b>    FUNCTION</b>
	This function is a copy of the pool functions in V39 and up of
	EXEC.  In fact, if you are running in V39, this function will
	notice and call the EXEC function.  This function works in
	V33 and up (1.2) Amiga system.

	The C code interface is _LibFreePooled() and takes its arguments
	from the stack just like the C code interface for <a href="../Includes_and_Autodocs_3._guide/node020F.html">FreePooled()</a>
	in amiga.lib.  The assembly code interface is with the symbol
	_AsmFreePooled: and takes the parameters in registers with the
	additional parameter of <a href="../Includes_and_Autodocs_3._guide/node0609.html#line33">ExecBase</a> being in a6 which can be used
	from SAS/C 6 by a prototype of:

	void __asm AsmFreePooled(register __a0 void *,
	                         register __a1 void *,
	                         register __d0 ULONG,
	                         register __a6 struct <a href="../Includes_and_Autodocs_3._guide/node0609.html#line33">ExecBase</a> *);

	Deallocates memory allocated by <a href="../Includes_and_Autodocs_3._guide/node0043.html">LibAllocPooled()</a>.  The size of the
	allocation *MUST* match the size given to <a href="../Includes_and_Autodocs_3._guide/node0043.html">LibAllocPooled()</a>.
	The reason the pool functions do not track individual allocation
	sizes is because many of the uses of pools have small allocation
	sizes and the tracking of the size would be a large overhead.

	Only memory allocated by <a href="../Includes_and_Autodocs_3._guide/node0043.html">LibAllocPooled()</a> may be freed with this
	function!

	Doing a <a href="../Includes_and_Autodocs_3._guide/node0045.html">LibDeletePool()</a> on the pool will free all of the puddles
	and thus all of the allocations done with <a href="../Includes_and_Autodocs_3._guide/node0043.html">LibAllocPooled()</a> in that
	pool.  (No need to LibFreePooled() each allocation)

<b>    INPUTS</b>
	memory - pointer to memory allocated by <a href="../Includes_and_Autodocs_3._guide/node01E8.html">AllocPooled</a>.
	poolHeader - a specific private pool header.

<b>    NOTES</b>
	The pool function do not protect an individual pool from
	multiple accesses.  The reason is that in most cases the pools
	will be used by a single task.  If your pool is going to
	be used by more than one task you must Semaphore protect
	the pool from having more than one task trying to allocate
	within the same pool at the same time.  Warning:  <a href="../Includes_and_Autodocs_3._guide/node020C.html">Forbid()</a>
	protection *will not work* in the future.  *Do NOT* assume
	that we will be able to make it work in the future.  LibFreePooled()
	may well break a <a href="../Includes_and_Autodocs_3._guide/node020C.html">Forbid()</a> and as such can only be protected
	by a semaphore.

	To track sizes yourself, the following code can be used:
	*Assumes a6=ExecBase*

	;
	; Function to do AllocVecPooled(Pool,memSize)
	;
	AllocVecPooled:	addq.l	#4,d0		; Get space for tracking
			move.l	d0,-(sp)	; Save the size
			jsr	<a href="../Includes_and_Autodocs_3._guide/node0043.html">LibAllocPooled</a>	; Call pool...
			move.l	(sp)+,d1	; Get size back...
			tst.l	d0		; Check for error
			beq.s	avp_fail	; If NULL, failed!
			move.l	d0,a0		; Get pointer...
			move.l	d1,(a0)+	; Store size
			move.l	a0,d0		; Get result
	avp_fail:	rts			; return

	;
	; Function to do LibFreeVecPooled(pool,memory)
	;
	FreeVecPooled:	move.l	-(a1),d0	; Get size / ajust pointer
			jmp	LibFreePooled

<b>    SEE ALSO</b>
	<a href="../Includes_and_Autodocs_3._guide/node01E8.html">AllocPooled()</a>, <a href="../Includes_and_Autodocs_3._guide/node01FD.html">CreatePool()</a>, <a href="../Includes_and_Autodocs_3._guide/node0202.html">DeletePool()</a>,
	<a href="../Includes_and_Autodocs_3._guide/node0043.html">LibAllocPooled()</a>, <a href="../Includes_and_Autodocs_3._guide/node0044.html">LibCreatePool()</a>, <a href="../Includes_and_Autodocs_3._guide/node0045.html">LibDeletePool()</a>
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
