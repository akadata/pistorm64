SOURCE: Includes_and_Autodocs_2._guide/node059B.html
TITLE: Text_Autodocs/keymap.doc

Text_Autodocs/keymap.doc ]" border=0> TABLE OF CONTENTS keymap.library/AskKeyMapDefault keymap.library/MapANSI keymap.library/MapRawKey keymap.library/SetKeyMapDefault keymap.library/AskKeyMapDefault keymap.library/AskKeyMapDefault NAME AskKeyMapDefault -- Ask for a pointer to the current default keymap. (V36) SYNOPSIS keyMap = AskKeyMapDefault() struct KeyMap *AskKeyMapDefault( VOID ); FUNCTION Return a pointer to the keymap used by the keymap library for MapRawKey and MapANSI when a keymap is not specified. RESULTS keyMap - a pointer to a keyMap structure. This key map is guaranteed to be permanently allocated: it will remain in memory till the machine is reset. BUGS The keymap.h include file should be in the libraries/ or perhaps resources/ directory, but is in the devices/ directory for compatability reasons. SEE ALSO devices/keymap.h, keymap.library/SetKeyMapDefault(), console.device ...KEYMAP functions keymap.library/MapANSI keymap.library/MapANSI NAME MapANSI -- Encode an ANSI string into keycodes. (V36) SYNOPSIS actual = MapANSI( string, count, buffer, length, keyMap ) D0 A0 D0 A1 D1 A2 LONG MapANSI( STRPTR, LONG, STRPTR, LONG, struct KeyMap * ); FUNCTION This console function converts an ANSI byte string to the code/qualifier pairs of type IECLASS_RAWKEY that would generate the string and places those pairs in a buffer. A code/qualifier pair is a pair of bytes suitable for putting in the ie_Code and low byte of ie_Qualifier, and for subsequent events, shifted to the ie_Prev1DownCode/ ie_Prev1DownQual then ie_Prev2DownCode/ie_Prev2DownQual pairs for any dead or double dead key mapping. INPUTS string - the ANSI string to convert. count - the number of characters in the string. buffer - a byte buffer large enough to hold all anticipated code/qualifier pairs generated by this conversion. length - maximum anticipation, i.e. the buffer size in bytes divided by two (the size of the code/qualifier pair). keyMap - a KeyMap structure pointer, or null if the default key map is to be used. RESULT actual - the number of code/qualifier pairs in the buffer, or negative to describe an error (see below). EXAMPLE ... #include #define STIMSIZE 3 /* two dead keys, one key */ unsigned char rBuffer[STIMSIZE*2]; ... KeymapBase = (struct Library *) OpenLibrary("keymap.library", 0); ... event.ie_NextEvent = 0; event.ie_Class = IECLASS_RAWKEY; event.ie_SubClass = 0; /* prove keymap code completeness and MapANSI reversibility */ for (code = 0; code UserPort); while (im = (struct IntuiMessage *) GetMsg(window->UserPort)) { switch (im->Class) { case RAWKEY: ie.ie_Code = im->Code; ie.ie_Qualifier = im->Qualifier; /* recover dead key codes & qualifiers */ ie.ie_EventAddress = (APTR *) *im->IAddress; actual = MapRawKey(&ie, buffer, BUFFERLEN, 0); for (i = 0; i [Back to Amiga Developer Docs ]
