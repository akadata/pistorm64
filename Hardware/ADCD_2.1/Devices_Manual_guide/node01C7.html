<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="Devices/Dev_A_EA_IFF_85" NODE="16-1-4" TITLE=" A Quick Introduction to IFF / What does an IFF file look like?" INDEX="Devices/Dev_Index/MAIN" -->
<head>
<title> A Quick Introduction to IFF / What does an IFF file look like?</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<a href="../Devices_Manual_guide/node012A.html"><img src="../images/index.gif" alt="[Index]" border=0></a>
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Devices_Manual_guide/node01C6.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Devices_Manual_guide/node01C8.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->
IFF is based on data blocks called &#034;chunk&#034;s. Here's an example color map
chunk:

                         +------------------+ in an ILBM file, CMAP means
          char typeID[4] | &#034;CMAP&#034;           | &#034;color map&#034;
                         |------------------+
  unsigned long dataSize |  48              | 48 data bytes
                         |------------------+
             char data[] |  0,0,0,255,      | 16 3-byte color values:
                         |  255,255,255...  | black, white, ....
                         +------------------+

                         +------------------+ in an ILBM file, CMAP means
                         | &#034;CMAP&#034;           | &#034;color map&#034;
                         |------------------+
                         |  48              | 48 data bytes
                         |------------------+
                         |  0,0,0,255,      | 16 3-byte color values:
                         |  255,255,255...  | black, white, ....
                         +------------------+

A chunk is made of a 4-character type identifier, a 32 bit data byte
count, and the data bytes. It's like a Macintosh &#034;resource&#034; with a 32-bit
size.

Fine points:

 o Every 16- and 32-bit number is stored in 68000 byte order - highest
    byte first.

   An Intel CPU must reverse the 2- or 4-byte sequence of each number.
   This applies to chunk dataSize fields and to numbers inside chunk
   data.  It does not affect character strings and byte data because you
   can't reverse a 1-byte sequence.  But it does affect the 32-bit math
   used in IFF's MakeID macro.  The standard does allow CPU specific byte
   ordering hidden within a chunk itself, but the practice is discouraged.

 o Every 16- and 32-bit number is stored on an even address.

 o Every odd-length chunk must be followed by a 0 pad byte.  This pad
    byte is not counted in dataSize.

 o An ID is made of 4 ASCII characters in the range &#034; &#034; (space, hex 20)
    through &#034;~&#034; (tilde, hex 7E).  Leading spaces are not permitted.

 o IDs are compared using a quick 32-bit equality test.  Case matters.

A chunk typically holds a C structure, Pascal record, or an array.  For
example, an <a href="../Devices_Manual_guide/node01AC.html">ILBM</a> picture has a <a href="../Devices_Manual_guide/node01AF.html">BMHD</a> bitmap header chunk (a structure)
<a name="line51">and a <a href="../Devices_Manual_guide/node01B7.html">BODY</a> raster body chunk (an array).</a>
<a name="line52"></a>
To construct an IFF file, just put a file type ID (like <a href="../Devices_Manual_guide/node01AC.html">ILBM</a>) into a
wrapper chunk called a &#034;FORM&#034; (Think &#034;FILE&#034;).  Inside that wrapper place
chunks one after another (with pad bytes as needed).  The chunk size
always tells you how many more bytes you need to skip over to get to the
next chunk.

	          +------------------+
	          |                  |
	          |  &#034;FORM&#034;          |  FORM is a special chunk ID
	          |                  |
	          +------------------+
	          |   24070          |  24070 data bytes
	       -- +------------------+
	       |  |                  |
	       |  |  &#034;ILBM&#034;          |  FORM type is ILBM
	       |  |                  |
	       |  | +--------------+ |
	       |  | |  &#034;BMHD&#034;      | |  A BMHD bitmap header chunk
	       |  | |--------------| |  (20 data bytes)
	       |  | |   20         | |
	       |  | |--------------| |
	       |  | |  320, 200,   | |
	       |  | |  0 ....      | |
	       |  | +--------------+ |
	       |  |                  |
	       |  | +--------------+ |
	       |  | |  &#034;CMAP&#034;      | |  A CMAP color map chunk
	24070 &#060;   | |--------------| |  (21 data bytes = 1 pad)
	bytes  |  | |   21         | |
	       |  | |--------------| |
	       |  | |  0, 0, 0,    | |
	       |  | |  255 ....    | |
	       |  | +--------------+ |
	       |  |   0              |  A pad byte
	       |  | +--------------+ |
	       |  | |  &#034;BODY&#034;      | |
	       |  | |--------------| |  A BODY raster body chunk
	       |  | |  24000       | |  (24000 data bytes)
	       |  | |--------------| |
	       |  | |  0, 0, 0.... | |
	       |  | +--------------+ |
<a name="line94">	       -- +------------------+</a>

A FORM always contains one 4-character FORM type ID (a file type, in this
case &#034;<a href="../Devices_Manual_guide/node01AC.html">ILBM</a>&#034;) followed by any number of data chunk.  In this example, the
FORM type is &#034;ILBM&#034;, which stands for &#034;InterLeaved BitMap&#034;.  (<a href="../Devices_Manual_guide/node01AC.html">ILBM</a> is an
IFF standard for bitplane raster pictures.)  This example has 3 chunks.
Note the pad byte after the odd length chunk.

Within FORMs <a href="../Devices_Manual_guide/node01AC.html">ILBM</a>, <a href="../Devices_Manual_guide/node01AF.html">BMHD</a> identifies a bitmap header chunk, <a href="../Devices_Manual_guide/node01B0.html">CMAP</a> a color
map, and <a href="../Devices_Manual_guide/node01B7.html">BODY</a> a raster body.  In general, the chunk IDs in a FORM are
local to the FORM type ID.  The  exceptions are the 4 global chunk IDs
&#034;FORM&#034;, <a href="../Devices_Manual_guide/node01CA.html#line49">LIST</a>, <a href="../Devices_Manual_guide/node01CA.html#line2">CAT</a> , and <a href="../Devices_Manual_guide/node01CA.html#line49">PROP</a>.  (A FORM may contain other FORM
chunks.  E.g., an animation FORM might contain picture FORMs and sound
FORMs.)
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
