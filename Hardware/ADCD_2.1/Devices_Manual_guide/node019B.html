<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="Devices/Dev_examples/Set_Mouse.c" NODE="MAIN" TITLE="Devices/Dev_examples/Set_Mouse.c" -->
<head>
<title>Devices/Dev_examples/Set_Mouse.c</title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<img src="../images/index_d.gif" alt="[Index]">
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Devices_Manual_guide/node019A.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Devices_Manual_guide/node019C.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->
/*
 * Set_Mouse.c
 *
 * This example sets the mouse at x=100 and y=200
 *
 * Compile with SAS C 5.10: LC -b1 -cfistq -v -y -L
 * Requires Kickstart 36 or greater.
 *
 * Run from CLI only
 */

#include &#060;exec/types.h&#062;
#include &#060;exec/memory.h&#062;
#include &#060;devices/input.h&#062;
#include &#060;devices/inputevent.h&#062;
#include &#060;intuition/screens.h&#062;

#include &#060;clib/exec_protos.h&#062;
#include &#060;clib/intuition_protos.h&#062;

#include &#060;stdio.h&#062;

#ifdef LATTICE
int CXBRK(void) { return(0); }  /* Disable SAS CTRL/C handling */
int chkabort(void) { return(0); }  /* really */
#endif

struct IntuitionBase *IntuitionBase;

void main(void)
{
struct IOStdReq   *InputIO;           /* I/O request block */
struct MsgPort    *InputMP;           /* Message port */
struct InputEvent *FakeEvent;         /* InputEvent pointer */
struct IEPointerPixel *NeoPix;      /* New mouse position pointer */
struct Screen *PubScreen;             /* Screen pointer */

if (InputMP = CreateMsgPort())
    {
    if (FakeEvent = AllocMem(sizeof(struct InputEvent),MEMF_PUBLIC))
        {
        if (NeoPix  = AllocMem(sizeof(struct IEPointerPixel),MEMF_PUBLIC))
            {
            if (InputIO = CreateIORequest(InputMP,sizeof(struct IOStdReq)))
                {
                if (!OpenDevice(&#034;input.device&#034;,NULL,
                               (struct IORequest *)InputIO,NULL))
                    {
                        /* Open Intuition library */
                    if (IntuitionBase=(struct IntuitionBase *)
                                      OpenLibrary(&#034;intuition.library&#034;,36L))
                        {
                        /* Get pointer to screen and lock screen */
                        if (PubScreen=(struct Screen *)LockPubScreen(NULL))
                            {
                            /* Set up IEPointerPixel fields */
                            /* WB screen */
                            NeoPix-&#062;iepp_Screen=(struct Screen *)PubScreen;
                            /* put pointer at x = 100 */
                            NeoPix-&#062;iepp_Position.X = 100;
                            /* put pointer at y = 200 */
                            NeoPix-&#062;iepp_Position.Y = 200;

                            /* Set up InputEvent fields */
                            /* IEPointerPixel */
                            FakeEvent-&#062;ie_EventAddress = (APTR)NeoPix;
                            FakeEvent-&#062;ie_NextEvent = NULL;
                            /* new mouse pos */
                            FakeEvent-&#062;ie_Class = IECLASS_NEWPOINTERPOS;
                            /* on pixel */
                            FakeEvent-&#062;ie_SubClass = IESUBCLASS_PIXEL;
                            FakeEvent-&#062;ie_Code = IECODE_NOBUTTON;
                            /* absolute positioning */
                            FakeEvent-&#062;ie_Qualifier = NULL;

                            /* InputEvent */
                            InputIO-&#062;io_Data = (APTR)FakeEvent;
                            InputIO-&#062;io_Length = sizeof(struct InputEvent);
                            InputIO-&#062;io_Command = IND_WRITEEVENT;
                            DoIO((struct IORequest *)InputIO);
                            /* Unlock screen */
                            UnlockPubScreen(NULL,PubScreen);
                            }
                        else
                            printf(&#034;Could not get pointer to screen\n&#034;);
                        /* Close intuition library */
                        CloseLibrary(IntuitionBase);
                        }
                    else
                        /* Can't open V36 (or higher) intuition.library */
                        printf(&#034;Error:Can't open V36 intuition.library\n&#034;);

                    CloseDevice((struct IORequest *)InputIO);
                    }
                else
                    printf(&#034;Error: Could not open input.device\n&#034;);

                DeleteIORequest(InputIO);
                }
            else
                printf(&#034;Error: Could not create IORequest\n&#034;);

            FreeMem(NeoPix,sizeof(struct IEPointerPixel));
            }
        else
            printf(&#034;Error: Could not allocate memory for NeoPix\n&#034;);

        FreeMem(FakeEvent,sizeof(struct InputEvent));
        }
    else
        printf(&#034;Error: Could not allocate memory for FakeEvent\n&#034;);

    DeleteMsgPort(InputMP);
    }
else
    printf(&#034;Error: Could not create message port\n&#034;);
}
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
