<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/34.11 FILE="Devices/Dev_A_FS_8SVX" NODE="16-6-2-4" TITLE=" Standard Data and Property Chunks / Optional Data Chunks ATAK and RLSE " INDEX="Devices/Dev_Index/MAIN" -->
<head>
<title> Standard Data and Property Chunks / Optional Data Chunks ATAK and RLSE </title>
</head>
<body>
<img src="../images/toc_d.gif" alt="[Contents]">
<a href="../Devices_Manual_guide/node012A.html"><img src="../images/index.gif" alt="[Index]" border=0></a>
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../Devices_Manual_guide/node02CE.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../Devices_Manual_guide/node02D0.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->
The optional data chunks ATAK and <a href="../Devices_Manual_guide/node02CF.html">RLSE</a> together give a piecewise-linear
&#034;envelope&#034; or &#034;amplitude contour&#034;.  This contour may be used to modulate
the sound during playback.  It's especially useful for playing musical
notes of variable durations.  Playback programs may ignore the supplied
envelope or substitute another.

    #define ID_ATAK MakeID('A', 'T', 'A', 'K')
    #define ID_RLSE MakeID('R', 'L', 'S', 'E')

    typedef struct {
        UWORD duration; /* segment duration in milliseconds, &#062; 0 */
        Fixed dest;     /* destination volume factor             */
        } EGPoint;

    /* ATAK and RLSE chunks contain an EGPoint[],        *
     * piecewise-linear envelope.                        */
    /* The envelope defines a function of time returning *
     * Fixed values. It's used to scale the nominal      *
     * volume specified in the Voice8Header.             */

To explain the meaning of the ATAK and RLSE chunks, we'll overview the
envelope generation algorithm.  Start at 0 volume, step through the ATAK
contour, then hold at the sustain level (the last ATAK EGPoint's dest),
and then step through the RLSE contour.  Begin the release at the desired
note stop time minus the total duration of the release contour (the sum of
the RLSE EGPoints' durations).  The attack contour should be cut short if
the note is shorter than the release contour.

The envelope is a piecewise-linear function.  The envelope generator
interpolates between the EGPoints.

Remember to multiply the envelope function by the nominal voice header
volume and by any desired note volume.

Figure 1 shows an example envelope.  The attack period is described by 4
EGPoints in an ATAK chunk.  The release period is described by 4 EGPoints
in a RLSE chunk.  The sustain period in the middle just holds the final
ATAK level until it's time for the release.


        ^
(volume)|               |             |
	|       .       |             |
	|      / \      |             |
	|     /   \.__. |             |
	|    /         \|_____________|
	|   /           |             |\.__.
	|  /            |             |     \
        | /             |             |      \
        |/              |             |       \
        +-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|---------&#062; (time)

              ATAK        sustain         RLSE

	      Figure 1. Amplitude contour.


Note: The number of EGPoints in an ATAK or RLSE chunk is its ckSize /
sizeof(EGPoint).  In RAM, the playback program may terminate the array
with a 0 duration EGPoint.

Issue: Synthesizers also provide frequency contour (pitch bend), filtering
contour (wah-wah), amplitude oscillation (tremolo), frequency oscillation
(vibrato), and filtering oscillation (leslie).  In the future, we may
define optional chunks to encode these modulations.  The contours can be
encoded in linear segments.  The oscillations can be stored as segments
with rate and depth parameters.
<!-- AG2HTML: BODY=END -->
</pre>

<!-- [amigadev.elowar.com] Automatically generated content... -->
<hr />
<pre>[Back to <a href="http://amigadev.elowar.com/">Amiga Developer Docs</a>]</pre>
<!-- [amigadev.elowar.com] End of automatically generated content. -->

</body>
</html>
